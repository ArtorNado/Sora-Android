buildscript {

    ext.versions = [
            kotlin            : '1.3.11',
            androidSupport    : '28.0.0-alpha3',
            javaAnnotations   : '1.3.1',
            dagger            : '2.17',
            javaxInject       : '1',
            rxJava2           : '2.2.7',
            rxBinding         : '2.1.1',
            supportTestRunner : '1.0.2',
            espresso          : '3.0.2',
            retrofit          : '2.4.0',
            soraSdk           : '0.3.10',
            logger            : '2.2.0',
            gson              : '2.8.5',
            firebaseCore      : '17.0.0',
            firebaseMessaging : '19.0.1',
            support           : '1.0.0',
            constraint        : '1.1.3',
            multidex          : '2.0.0',
            crashlytics       : '2.9.8@aar',
            iroha             : '5.1.2',
            shimmer           : '0.4.0',
            novaCrypto        : '0.1.9',
            navigationFragment: '2.0.0-rc02',
            zXing             : '3.3.3',
            zXingEmbedded     : '3.5.0@aar',
            birt              : '2.9.0',
            phoenix           : '2.0.0',
            dexter            : '5.0.0',
            navigation        : '2.0.0-rc02',
            roundedImage      : '2.3.0',
            picasso           : '2.71828',
            capital           : '1.0.21-SNAPSHOT',
            jUnit             : '4.12',
            mockito           : '2.23.0',
            robolectric       : '4.1',
            archCoreTest      : '2.0.0',
            archFragmentTest  : '1.1.0-beta01',
            rxPermissions     : '0.10.2',
            rxAndroid         : '2.1.0',
            archComponents    : '2.0.0',
            room              : '2.2.0-alpha02',
            googleAuthApiPhone: '17.1.0',
            googleAuthApi     : '17.0.0'
    ]

    ext {
        appVersionCode = Integer.valueOf(System.env.BUILD_NUMBER ?: 13)
        appVersionName = '1.3.2'

        compileVersion = 28
        minVersion = 21
        targetVersion = 28

        kotlinDeps = [
                kotlin: "org.jetbrains.kotlin:kotlin-stdlib-jdk7:$versions.kotlin"
        ]

        loggerDeps = [
                logger: "com.orhanobut:logger:$versions.logger"
        ]

        daggerDeps = [
                dagger: "com.google.dagger:dagger:$versions.dagger"
        ]

        daggerKapt = [
                dagger: "com.google.dagger:dagger-compiler:$versions.dagger"
        ]

        javaXInject = [
                inject : "javax.inject:javax.inject:$versions.javaxInject"
        ]

        lifecycleDeps = [
                lifecycleExt: "androidx.lifecycle:lifecycle-extensions:$versions.archComponents",
        ]

        lifecycleKapt = [
                compiler: "androidx.lifecycle:lifecycle-compiler:$versions.archComponents"
        ]

        roomDependencies = [
                room      : "androidx.room:room-runtime:$versions.room",
                rxJavaRoom: "androidx.room:room-rxjava2:$versions.room"
        ]

        kaptRoomDependencies = [
                roomKapt: "androidx.room:room-compiler:$versions.room"
        ]

        rxDeps = [
                rxJava2: "io.reactivex.rxjava2:rxjava:$versions.rxJava2"
        ]

        rxAndroidDeps = [
                rxAndroid: "io.reactivex.rxjava2:rxandroid:$versions.rxAndroid"
        ]

        rxBindingDeps = [
                rxBinding   : "com.jakewharton.rxbinding2:rxbinding:$versions.rxBinding",
                v4          : "com.jakewharton.rxbinding2:rxbinding-support-v4:$versions.rxBinding",
                appCompat   : "com.jakewharton.rxbinding2:rxbinding-appcompat-v7:$versions.rxBinding",
                design      : "com.jakewharton.rxbinding2:rxbinding-design:$versions.rxBinding",
                recyclerView: "com.jakewharton.rxbinding2:rxbinding-recyclerview-v7:$versions.rxBinding"
        ]

        firebaseDeps = [
                core     : "com.google.firebase:firebase-core:$versions.firebaseCore",
                messaging: "com.google.firebase:firebase-messaging:$versions.firebaseMessaging"
        ]

        androidDeps = [
                appCompat : "androidx.appcompat:appcompat:$versions.support",
                v4        : "androidx.legacy:legacy-support-v4:$versions.support",
                constraint: "androidx.constraintlayout:constraintlayout:$versions.constraint",
                material  : "com.google.android.material:material:$versions.support",
                cardView  : "androidx.cardview:cardview:$versions.support",
                vector    : "androidx.vectordrawable:vectordrawable:$versions.support"
        ]

        multidexDeps = [
                multidex: "androidx.multidex:multidex:$versions.multidex"
        ]

        crashlyticsDeps = [
                fabric: "com.crashlytics.sdk.android:crashlytics:2.9.8@aar"
        ]

        irohaDeps = [
                iroha: "com.github.hyperledger.iroha-java:client:$versions.iroha"
        ]

        soraDeps = [
                sora: "com.github.soramitsu:sora-sdk:$versions.soraSdk"
        ]

        shimmerDeps = [
                shimmer: "com.facebook.shimmer:shimmer:$versions.shimmer"
        ]

        novaCryptoDeps = [
                novaCrypto: "io.github.novacrypto:BIP39:$versions.novaCrypto"
        ]

        navigationDeps = [
                fragment: "androidx.navigation:navigation-fragment:$versions.navigationFragment",
                ui      : "androidx.navigation:navigation-ui:$versions.navigationFragment"
        ]

        capitalDeps = [
                informationCard   : "jp.co.soramitsu.capital_android:account-information-card:$versions.capital@aar",
                informationList   : "jp.co.soramitsu.capital_android:account-information-list:$versions.capital@aar",
                accountSelector   : "jp.co.soramitsu.capital_android:account-selector-item:$versions.capital@aar",
                buttonFullWidth   : "jp.co.soramitsu.capital_android:button-full-width:$versions.capital@aar",
                ui                : "jp.co.soramitsu.capital_android:capital-ui:$versions.capital@aar",
                contactEntry      : "jp.co.soramitsu.capital_android:contact-entry:$versions.capital@aar",
                contactEntryList  : "jp.co.soramitsu.capital_android:contact-entry-list:$versions.capital@aar",
                coreUi            : "jp.co.soramitsu.capital_android:core-ui:$versions.capital@aar",
                doubleButton      : "jp.co.soramitsu.capital_android:double-button:$versions.capital@aar",
                filter            : "jp.co.soramitsu.capital_android:filter:$versions.capital@aar",
                information       : "jp.co.soramitsu.capital_android:information-element:$versions.capital@aar",
                operationButton   : "jp.co.soramitsu.capital_android:operation-button:$versions.capital@aar",
                recentEvents      : "jp.co.soramitsu.capital_android:recent-events:$versions.capital@aar",
                transactionDetails: "jp.co.soramitsu.capital_android:transaction-details:$versions.capital@aar"
        ]

        zXingDeps = [
                core    : "com.google.zxing:core:$versions.zXing",
                embedded: "com.journeyapps:zxing-android-embedded:$versions.zXingEmbedded"
        ]

        gsonDeps = [
                gson: "com.google.code.gson:gson:$versions.gson"
        ]

        networkDeps = [
                retrofit     : "com.squareup.retrofit2:retrofit:$versions.retrofit",
                gsonConverter: "com.squareup.retrofit2:converter-gson:$versions.retrofit",
                rxCallAdapter: "com.squareup.retrofit2:adapter-rxjava2:$versions.retrofit"
        ]

        birtDeps = [
                birt: "org.eclipse.birt.runtime.3_7_1:org.apache.xerces:$versions.birt"
        ]

        phoenixDeps = [
                phoenix: "com.jakewharton:process-phoenix:$versions.phoenix"
        ]

        dexterDeps = [
                dexter: "com.karumi:dexter:$versions.dexter"
        ]

        roundedImageViewDeps = [
                imageView: "com.makeramen:roundedimageview:$versions.roundedImage"
        ]

        picassoDeps = [
                picasso: "com.squareup.picasso:picasso:$versions.picasso"
        ]

        rxPermissionsDeps = [
                rxPermissions: "com.github.tbruyelle:rxpermissions:$versions.rxPermissions"
        ]

        unitTestsDeps = [
                jUnit  : "junit:junit:$versions.jUnit",
                mockito: "org.mockito:mockito-inline:$versions.mockito"
        ]

        robolectricDeps = [
                robolectric: "org.robolectric:robolectric:$versions.robolectric",
                multidex   : "org.robolectric:shadows-multidex:$versions.robolectric"
        ]

        archTestDeps = [
                core    : "androidx.arch.core:core-testing:$versions.archCoreTest",
                fragment: "androidx.fragment:fragment-testing:$versions.archFragmentTest"
        ]

        authApiDeps = [
                authApiPhone: "com.google.android.gms:play-services-auth-api-phone:$versions.googleAuthApiPhone",
                auth        : "com.google.android.gms:play-services-auth:$versions.googleAuthApi"
        ]
    }

    repositories {
        google()
        jcenter()
        maven { url 'https://maven.fabric.io/public' }
    }
    dependencies {
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:${versions.kotlin}"
        classpath 'com.android.tools.build:gradle:3.4.2'
        classpath 'com.google.gms:google-services:4.2.0'
        classpath 'io.fabric.tools:gradle:1.+'
    }
}

plugins {
    id "org.sonarqube" version "2.7"
}

allprojects {
    repositories {
        maven {
            url "https://nexus.iroha.tech/repository/maven-capital/"
        }
        google()
        jcenter()
        maven {
            url "https://jitpack.io"
        }
    }
}

task clean(type: Delete) {
    delete rootProject.buildDir
}

configurations {
    ktlint
}

dependencies {
    ktlint 'com.github.shyiko:ktlint:0.31.0'
}

task ktlint(type: Exec, group: "verification") {
    commandLine 'java', '-cp', configurations.ktlint.join(System.getProperty('path.separator')),
            'com.github.shyiko.ktlint.Main',
            "--reporter=html,artifact=me.cassiano:ktlint-html-reporter:0.2.0,output=${project.buildDir}/reports/checkstyle/ktlint.html",
            "$project.rootDir/**/src/main/**/*.kt"
}